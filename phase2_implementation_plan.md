# Phase 2 実装計画 - 詳細決定のための相談事項

## Gemini相談依頼: Phase 2 完全実装仕様の決定

前回の戦略分析を受けて、**Phase 2 (OCR機能 + PWA化)** の具体的実装について、以下の観点で詳細な技術仕様と実装方針を決定したいと思います。

## 現在の技術スタック (Phase 1完成)
- **Frontend**: React 18 + TypeScript + Material-UI v5 + Vite
- **Backend**: Node.js + Express + TypeScript
- **Database**: Supabase PostgreSQL + RLS
- **Auth**: Demo JWT + Supabase認証
- **Deploy**: WSL2環境 (開発完了済み)

## 相談事項 1: OCR技術選択と実装方針

### 候補技術スタック
1. **Google Cloud Vision API**
   - 精度: 高い
   - コスト: 従量課金
   - 統合: REST API

2. **AWS Textract**
   - 精度: 高い (表形式に特化)
   - コスト: 従量課金
   - 統合: AWS SDK

3. **Azure Computer Vision**
   - 精度: 高い
   - コスト: 従量課金
   - 統合: REST API

4. **Tesseract.js (クライアントサイド)**
   - 精度: 中程度
   - コスト: 無料
   - 統合: フロントエンド直接実行

### 検討ポイント
- **コスト効率性**: 初期段階での従量課金リスク
- **精度要件**: シフト表特有のレイアウト対応
- **レスポンス性**: ユーザー体験への影響
- **セキュリティ**: 画像データの扱い
- **スケーラビリティ**: ユーザー増加への対応

**質問**: どの技術を選択し、どのようなアーキテクチャで実装すべきでしょうか？

## 相談事項 2: PWA実装戦略

### PWA機能要件
1. **オフライン対応**
   - キャッシュ戦略
   - データ同期方式

2. **プッシュ通知**
   - 扶養限度額警告
   - シフト入力リマインダー
   - 収入確定通知

3. **インストール促進**
   - A2HS (Add to Home Screen)
   - インストールバナー

### 技術選択
- **Service Worker**: Workbox vs 自作
- **通知サービス**: Firebase Cloud Messaging vs 他
- **オフライン DB**: IndexedDB vs WebSQL

**質問**: PWAの機能優先度と実装順序、推奨技術スタックを教えてください。

## 相談事項 3: フリーミアムモデル設計

### 機能分割案
**Freeプラン:**
- 手動シフト入力
- 基本収入計算
- OCR月5回まで

**Standardプラン (月額500円):**
- OCR無制限
- 複数バイト先管理
- プッシュ通知

**Proプラン (月額1000円):**
- 銀行API連携 (Phase 3)
- AI最適化提案 (Phase 4)

### UI/UX考慮事項
- 有料機能への誘導方法
- 制限表示の仕方
- アップグレード導線

**質問**: この料金体系は適切でしょうか？機能制限の設計方針についてアドバイスをお願いします。

## 相談事項 4: OCR UX設計

### ユーザーフロー
1. **画像アップロード**
   - ドラッグ&ドロップ
   - カメラ撮影
   - ファイル選択

2. **OCR処理**
   - プログレス表示
   - エラーハンドリング

3. **結果確認・修正**
   - 抽出データ表示
   - 手動修正UI
   - 確定ボタン

### 精度向上策
- 画像前処理 (回転補正、コントラスト調整)
- OCR結果の信頼度表示
- 学習データ蓄積による改善

**質問**: 最適なUXフローと精度向上のための実装方針を教えてください。

## 相談事項 5: セキュリティとプライバシー

### 画像処理
- サーバーサイド vs クライアントサイド
- 画像データの保存期間
- 暗号化要件

### ユーザーデータ
- OCR結果の保存方針
- エラーログの管理
- GDPR/個人情報保護法対応

**質問**: セキュリティを重視した実装方針とデータ管理ポリシーを教えてください。

## 相談事項 6: 開発・テスト戦略

### 開発手順
1. OCR API統合 (バックエンド)
2. 画像アップロード機能 (フロントエンド)
3. 結果確認・修正UI
4. PWAマニフェスト実装
5. Service Worker実装
6. プッシュ通知実装
7. 有料機能制限実装

### テスト戦略
- OCR精度評価方法
- PWA機能テスト
- パフォーマンステスト
- セキュリティテスト

**質問**: 効率的な開発順序と品質保証の方針を教えてください。

## 期待する回答内容

1. **技術選択の具体的推奨**
2. **実装優先順序の詳細**
3. **コスト効率的な開発方針**
4. **リスク回避策**
5. **成功指標の具体的設定方法**
6. **Phase 3への移行タイミング**

**特に重視する観点**: 実装コストとユーザー価値のバランス、技術的実現可能性、ビジネス成長への貢献度を総合的に考慮した提案をお願いします。