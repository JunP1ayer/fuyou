<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‰¶é¤Šãƒ—ãƒ­ - æ©Ÿèƒ½å‹•ä½œãƒ†ã‚¹ãƒˆ</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
        .test-btn { background: #4CAF50; color: white; padding: 12px 24px; border: none; border-radius: 5px; cursor: pointer; margin: 5px; min-height: 44px; }
        .test-btn:active { transform: scale(0.95); }
        .result { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .success { background: #d4edda; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; border: 1px solid #bee5eb; }
        .touch-test { height: 80px; background: #f0f0f0; border: 2px dashed #ccc; display: flex; align-items: center; justify-content: center; margin: 10px 0; border-radius: 8px; user-select: none; }
        .calendar-day { width: 40px; height: 40px; border: 1px solid #ddd; display: inline-block; margin: 2px; text-align: center; line-height: 40px; cursor: pointer; border-radius: 4px; }
        .calendar-day:hover { background: #f0f8ff; }
    </style>
</head>
<body>
    <h1>ğŸ“± æ‰¶é¤Šãƒ—ãƒ­æ©Ÿèƒ½å‹•ä½œãƒ†ã‚¹ãƒˆ</h1>
    
    <div class="test-section">
        <h2>ğŸ”§ åŸºæœ¬æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</h2>
        <button class="test-btn" onclick="testBasicFunctions()">åŸºæœ¬é–¢æ•°ãƒã‚§ãƒƒã‚¯</button>
        <button class="test-btn" onclick="testServiceWorker()">Service Workerç¢ºèª</button>
        <button class="test-btn" onclick="testLocalStorage()">ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ç¢ºèª</button>
        <div id="basicResults"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ“± ã‚¿ãƒƒãƒåå¿œãƒ†ã‚¹ãƒˆ</h2>
        <button class="test-btn" onclick="testTouchFeedback(this)">ã‚¿ãƒƒãƒãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆ</button>
        <button class="test-btn" onclick="testVibration()">ãƒã‚¤ãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç¢ºèª</button>
        <div class="touch-test" id="touchArea" ontouchstart="handleTouchStart(event)" ontouchend="handleTouchEnd(event)">
            ã“ã“ã‚’ã‚¿ãƒƒãƒã—ã¦åå¿œç¢ºèª
        </div>
        <div id="touchResults"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ“‹ ã‚¹ãƒ¯ã‚¤ãƒ—ãƒ»ã‚¸ã‚§ã‚¹ãƒãƒ£ãƒ¼ãƒ†ã‚¹ãƒˆ</h2>
        <div class="touch-test" id="swipeArea" ontouchstart="handleSwipeStart(event)" ontouchmove="handleSwipeMove(event)" ontouchend="handleSwipeEnd(event)">
            å·¦å³ã«ã‚¹ãƒ¯ã‚¤ãƒ—ã—ã¦ãã ã•ã„
        </div>
        <div id="swipeResults"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ—“ï¸ ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ãƒ†ã‚¹ãƒˆ</h2>
        <div style="margin: 10px 0;">
            <div class="calendar-day" draggable="true" ondragstart="handleDragStart(event)" data-shift-id="test-shift">1</div>
            <div class="calendar-day" ondragover="handleDragOver(event)" ondrop="handleDrop(event)" data-date="2024-01-02">2</div>
            <div class="calendar-day" ondragover="handleDragOver(event)" ondrop="handleDrop(event)" data-date="2024-01-03">3</div>
        </div>
        <p>ã€Œ1ã€ã‚’ã€Œ2ã€ã¾ãŸã¯ã€Œ3ã€ã«ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦ãã ã•ã„</p>
        <div id="dragResults"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ”” é€šçŸ¥ãƒ»ãƒˆãƒ¼ã‚¹ãƒˆãƒ†ã‚¹ãƒˆ</h2>
        <button class="test-btn" onclick="testToast('success')">æˆåŠŸãƒˆãƒ¼ã‚¹ãƒˆ</button>
        <button class="test-btn" onclick="testToast('error')">ã‚¨ãƒ©ãƒ¼ãƒˆãƒ¼ã‚¹ãƒˆ</button>
        <button class="test-btn" onclick="testToast('info')">æƒ…å ±ãƒˆãƒ¼ã‚¹ãƒˆ</button>
        <div id="toastResults"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ“Š ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªé€£æºãƒ†ã‚¹ãƒˆ</h2>
        <button class="test-btn" onclick="openMainApp()">ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚’é–‹ã</button>
        <button class="test-btn" onclick="testMainAppFunctions()">ãƒ¡ã‚¤ãƒ³é–¢æ•°ç¢ºèª</button>
        <div id="mainAppResults"></div>
    </div>

    <script>
        let touchStartTime = 0;
        let swipeStartX = 0;
        let swipeStartY = 0;

        // åŸºæœ¬æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
        function testBasicFunctions() {
            const results = document.getElementById('basicResults');
            let html = '';
            
            // JavaScriptåŸºæœ¬ãƒã‚§ãƒƒã‚¯
            try {
                const testVar = 'test';
                html += '<div class="result success">âœ… JavaScriptå®Ÿè¡Œç’°å¢ƒ: æ­£å¸¸</div>';
            } catch (e) {
                html += '<div class="result error">âŒ JavaScriptå®Ÿè¡Œç’°å¢ƒ: ã‚¨ãƒ©ãƒ¼</div>';
            }
            
            // DOMæ“ä½œãƒã‚§ãƒƒã‚¯
            try {
                const testDiv = document.createElement('div');
                html += '<div class="result success">âœ… DOMæ“ä½œ: æ­£å¸¸</div>';
            } catch (e) {
                html += '<div class="result error">âŒ DOMæ“ä½œ: ã‚¨ãƒ©ãƒ¼</div>';
            }
            
            // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ãƒã‚§ãƒƒã‚¯
            try {
                const testBtn = document.createElement('button');
                testBtn.addEventListener('click', () => {});
                html += '<div class="result success">âœ… ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼: æ­£å¸¸</div>';
            } catch (e) {
                html += '<div class="result error">âŒ ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼: ã‚¨ãƒ©ãƒ¼</div>';
            }
            
            results.innerHTML = html;
        }

        // Service Workerç¢ºèª
        function testServiceWorker() {
            const results = document.getElementById('basicResults');
            
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.getRegistrations().then(registrations => {
                    if (registrations.length > 0) {
                        results.innerHTML += '<div class="result success">âœ… Service Worker: ç™»éŒ²æ¸ˆã¿ (' + registrations.length + 'ä»¶)</div>';
                    } else {
                        results.innerHTML += '<div class="result info">â„¹ï¸ Service Worker: æœªç™»éŒ²</div>';
                    }
                });
            } else {
                results.innerHTML += '<div class="result error">âŒ Service Worker: ã‚µãƒãƒ¼ãƒˆå¤–</div>';
            }
        }

        // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ç¢ºèª
        function testLocalStorage() {
            const results = document.getElementById('basicResults');
            
            try {
                localStorage.setItem('test', 'value');
                const value = localStorage.getItem('test');
                localStorage.removeItem('test');
                
                if (value === 'value') {
                    results.innerHTML += '<div class="result success">âœ… ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸: æ­£å¸¸å‹•ä½œ</div>';
                } else {
                    results.innerHTML += '<div class="result error">âŒ ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸: èª­ã¿æ›¸ãã‚¨ãƒ©ãƒ¼</div>';
                }
            } catch (e) {
                results.innerHTML += '<div class="result error">âŒ ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸: ' + e.message + '</div>';
            }
        }

        // ã‚¿ãƒƒãƒãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ç¢ºèª
        function testTouchFeedback(button) {
            const results = document.getElementById('touchResults');
            
            // è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
            button.style.transform = 'scale(0.95)';
            button.style.transition = 'transform 0.1s ease';
            
            setTimeout(() => {
                button.style.transform = 'scale(1)';
            }, 100);
            
            results.innerHTML = '<div class="result success">âœ… è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯: å®Ÿè¡Œå®Œäº†</div>';
        }

        // ãƒã‚¤ãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç¢ºèª
        function testVibration() {
            const results = document.getElementById('touchResults');
            
            if (navigator.vibrate) {
                navigator.vibrate([100, 50, 100]);
                results.innerHTML += '<div class="result success">âœ… ãƒã‚¤ãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³: å®Ÿè¡Œå®Œäº†</div>';
            } else {
                results.innerHTML += '<div class="result info">â„¹ï¸ ãƒã‚¤ãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³: ã‚µãƒãƒ¼ãƒˆå¤–</div>';
            }
        }

        // ã‚¿ãƒƒãƒå‡¦ç†
        function handleTouchStart(event) {
            touchStartTime = Date.now();
            event.target.style.backgroundColor = '#e3f2fd';
            
            const results = document.getElementById('touchResults');
            results.innerHTML += '<div class="result info">ğŸ‘† ã‚¿ãƒƒãƒé–‹å§‹æ¤œå‡º</div>';
        }

        function handleTouchEnd(event) {
            const touchDuration = Date.now() - touchStartTime;
            event.target.style.backgroundColor = '#f0f0f0';
            
            const results = document.getElementById('touchResults');
            
            if (touchDuration > 500) {
                results.innerHTML += '<div class="result success">âœ… é•·æŠ¼ã—æ¤œå‡º: ' + touchDuration + 'ms</div>';
                if (navigator.vibrate) navigator.vibrate([10, 50, 10]);
            } else {
                results.innerHTML += '<div class="result info">ğŸ‘† ã‚¿ãƒƒãƒ—æ¤œå‡º: ' + touchDuration + 'ms</div>';
            }
        }

        // ã‚¹ãƒ¯ã‚¤ãƒ—å‡¦ç†
        function handleSwipeStart(event) {
            swipeStartX = event.touches[0].clientX;
            swipeStartY = event.touches[0].clientY;
        }

        function handleSwipeMove(event) {
            event.preventDefault();
        }

        function handleSwipeEnd(event) {
            const endX = event.changedTouches[0].clientX;
            const endY = event.changedTouches[0].clientY;
            
            const diffX = swipeStartX - endX;
            const diffY = swipeStartY - endY;
            
            const results = document.getElementById('swipeResults');
            
            if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 50) {
                if (diffX > 0) {
                    results.innerHTML = '<div class="result success">âœ… å·¦ã‚¹ãƒ¯ã‚¤ãƒ—æ¤œå‡º: ' + Math.round(diffX) + 'px</div>';
                } else {
                    results.innerHTML = '<div class="result success">âœ… å³ã‚¹ãƒ¯ã‚¤ãƒ—æ¤œå‡º: ' + Math.round(Math.abs(diffX)) + 'px</div>';
                }
                if (navigator.vibrate) navigator.vibrate(10);
            } else {
                results.innerHTML = '<div class="result info">â„¹ï¸ ã‚¹ãƒ¯ã‚¤ãƒ—è·é›¢ä¸è¶³: ' + Math.round(Math.abs(diffX)) + 'px</div>';
            }
        }

        // ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—å‡¦ç†
        function handleDragStart(event) {
            event.dataTransfer.setData('text/plain', event.target.dataset.shiftId);
            event.target.style.opacity = '0.5';
            
            const results = document.getElementById('dragResults');
            results.innerHTML = '<div class="result info">ğŸ“ ãƒ‰ãƒ©ãƒƒã‚°é–‹å§‹</div>';
        }

        function handleDragOver(event) {
            event.preventDefault();
            event.target.style.backgroundColor = '#e8f5e8';
        }

        function handleDrop(event) {
            event.preventDefault();
            const shiftId = event.dataTransfer.getData('text/plain');
            const newDate = event.target.dataset.date;
            
            event.target.style.backgroundColor = '';
            
            const results = document.getElementById('dragResults');
            results.innerHTML = '<div class="result success">âœ… ãƒ‰ãƒ­ãƒƒãƒ—æˆåŠŸ: ' + shiftId + ' â†’ ' + newDate + '</div>';
            
            if (navigator.vibrate) navigator.vibrate([10, 50, 10]);
            
            // å…ƒã®è¦ç´ ã‚’ãƒªã‚»ãƒƒãƒˆ
            document.querySelector('[data-shift-id="test-shift"]').style.opacity = '1';
        }

        // ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ãƒ†ã‚¹ãƒˆ
        function testToast(type) {
            const messages = {
                success: 'âœ… æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸',
                error: 'âŒ ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸', 
                info: 'â„¹ï¸ æƒ…å ±ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸'
            };
            
            showTestToast(messages[type], type);
            
            const results = document.getElementById('toastResults');
            results.innerHTML = '<div class="result success">âœ… ' + type + 'ãƒˆãƒ¼ã‚¹ãƒˆè¡¨ç¤ºå®Œäº†</div>';
        }

        function showTestToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.textContent = message;
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: ${type === 'success' ? '#4CAF50' : type === 'error' ? '#f44336' : '#2196F3'};
                color: white;
                padding: 12px 24px;
                border-radius: 24px;
                z-index: 10000;
                font-size: 14px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.parentNode.removeChild(toast);
                }
            }, 2000);
        }

        // ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªé€£æº
        function openMainApp() {
            window.open('fuyou-pro-app.html', '_blank');
        }

        function testMainAppFunctions() {
            const results = document.getElementById('mainAppResults');
            
            fetch('fuyou-pro-app.html')
                .then(response => response.text())
                .then(html => {
                    const functions = [
                        'enhanceTouchResponsiveness',
                        'initializeShiftBoardUX',
                        'showToast',
                        'moveShift'
                    ];
                    
                    let allFound = true;
                    let details = '';
                    
                    functions.forEach(func => {
                        const found = html.includes(`function ${func}`);
                        if (!found) allFound = false;
                        details += `<div class="result ${found ? 'success' : 'error'}">${found ? 'âœ…' : 'âŒ'} ${func}</div>`;
                    });
                    
                    results.innerHTML = details;
                    
                    if (allFound) {
                        showTestToast('âœ… å…¨ã¦ã®é–¢æ•°ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™', 'success');
                    } else {
                        showTestToast('âš ï¸ ä¸€éƒ¨ã®é–¢æ•°ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“', 'error');
                    }
                })
                .catch(error => {
                    results.innerHTML = '<div class="result error">âŒ ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã®ç¢ºèªã«å¤±æ•—: ' + error.message + '</div>';
                });
        }

        // åˆæœŸè¡¨ç¤º
        window.onload = function() {
            testBasicFunctions();
            testServiceWorker();
            testLocalStorage();
        };
    </script>
</body>
</html>